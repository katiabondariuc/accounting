<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Company App{% endblock %}</title>
    {% load static %}
    <script>
      (function() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.classList.add(savedTheme + '-theme');
        document.documentElement.style.background = savedTheme === 'dark' ? '#121212' : '#f9f9f9';
      })();
    </script>

    <link rel="stylesheet" href="{% static 'core/css/styles.css' %}?v=20251003-3">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>

<body class="light-theme">

    {% if request.user.is_authenticated %}

    <div class="sidebar">
        <h2>Company</h2>
        <ul>
            <li><a class="menu-btn" href="{% url 'supplier_list' %}">Agen»õi comerciali</a></li>
            <li><a class="menu-btn" href="{% url 'contract_list' %}">Contracte</a></li>
            <li><a class="menu-btn" href="{% url 'factura_list' %}">Facturi</a></li>
            <li><a class="menu-btn" href="{% url 'plata_list' %}">PlƒÉ»õi</a></li>
            <li><a class="menu-btn" href="{% url 'factura_archive' %}">ArhivƒÉ</a></li>
        </ul>
    </div>
    {% endif %}

    <div class="main-content">
        <header>
            {% if request.user.is_authenticated %}
                <div class="header-left">
                    <h1>{% block header %}{% endblock %}</h1>
                </div>
                <div class="header-right">
                    <button id="theme-toggle" class="btn">üåô</button>
                </div>
            {% endif %}
        </header>

        <section class="{% if not request.user.is_authenticated %}login-section{% endif %}">
            {% block content %}
            {% endblock %}
        </section>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
          flatpickr("input[type='date']", {
              dateFormat: "Y-m-d",
              allowInput: true
          });
      });
    </script>

    <script>
      (function () {
        const KEY = "ui_theme";
        const btn = document.getElementById("theme-toggle");

        const saved = localStorage.getItem(KEY);
        if (saved === "dark") {
          document.body.classList.remove("light-theme");
          document.body.classList.add("dark-theme");
          if (btn) btn.textContent = "‚òÄÔ∏è";
        } else {
          document.body.classList.remove("dark-theme");
          document.body.classList.add("light-theme");
          if (btn) btn.textContent = "üåô";
        }

        if (btn) {
          btn.addEventListener("click", function () {
            const dark = document.body.classList.toggle("dark-theme");
            document.body.classList.toggle("light-theme", !dark);
            btn.textContent = dark ? "‚òÄÔ∏è" : "üåô";
            localStorage.setItem(KEY, dark ? "dark" : "light");
          });
        }
      })();
    </script>

</body>
</html>
